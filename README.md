# 蛋白质序列二分类任务训练代码

## 项目概述
本项目使用ESMC预训练模型对蛋白质序列进行二分类任务，区分蛋白酶(标签1)和非蛋白酶(标签0)。

## 文件结构
- `train.py`: 主训练脚本
- `best_model.pth`: 训练过程中保存的最佳模型权重(运行后生成)
- `README.md`: 项目说明文档

## 环境要求
- Python 3.8+
- PyTorch 2.0+
- pandas
- scikit-learn
- esm (本项目提供的包)

## 数据格式
训练数据位于`data\balanced_protein_sequences.xlsx`，包含以下列：
- `id`: 序列标识符(未使用)
- `seq`: 蛋白质序列
- `label`: 分类标签(0或1)，1代表是蛋白酶

## 模型架构
- 基础模型：ESMC-600M预训练模型
- 分类头：两层全连接网络，包含ReLU激活函数和Dropout层

## 使用方法
1. 确保已安装所有依赖
2. 运行训练脚本：
   ```
   python AIModel\train.py
   ```

## 训练过程
1. 数据加载与预处理：读取Excel文件，分割训练集和测试集
2. 模型初始化：加载ESMC预训练模型，添加分类头
3. 模型训练：冻结预训练模型参数，仅训练分类头
4. 模型评估：在测试集上评估模型性能
5. 保存最佳模型：根据F1分数保存最佳模型权重

## 结果评估
训练过程中会输出以下指标：
- 损失(Loss)
- 准确率(Accuracy)
- 精确率(Precision)
- 召回率(Recall)
- F1分数(F1)

## 注意事项
- 默认使用GPU进行训练，如果没有GPU会自动切换到CPU
- 模型训练完成后，最佳模型会保存在`AIModel\best_model.pth`
- 可以通过修改`train.py`中的参数来调整训练过程(如学习率、 batch size等)